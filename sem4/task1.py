import matplotlib.pyplot as plt
import numpy as np

fig = plt.figure(figsize=(16, 9))
ax1 = fig.add_subplot(111)
U = np.array([66.5, 108.5, 137.7, 212.3, 259.5, 322.8, 403.8])
V1 = np.array([34.1, 58.1, 70.7, 109.8, 132.4, 164.6, 206.1])
ax1.scatter(U, V1, marker='.')
x = np.polyfit(U, V1, 1)
p = np.poly1d(x)
ax1.errorbar(U, V1, yerr=0.00002, xerr=0.11858, color='k', linestyle='None')
ax1.plot(U, p(U), 'k')
print(x)
plt.title('График W(M)', fontdict={'fontname': 'sans-serif', 'fontsize': 20})
plt.xlabel('M, H*м*10^-3')
plt.ylabel('W, с^-1')
#plt.xticks([0, 1, 2, 3, 4, 5, 6, 7])
#plt.yticks([0, 4, 8, 12, 16, 20, 24, 28])
ax1.grid()
plt.legend()
plt.show()
